<project name="alphaSynth" default="flashOnly" basedir=".">
    <description>
        a buildfile compiling alphaSynth
    </description>
    
    <!--*************************************************************************
        General
    **************************************************************************-->
    
    <!-- Main Properties -->
	<property name="bin" location="bin"/>
	<property name="src" location="src"/>

    <!--*************************************************************************
        Building Flash
    **************************************************************************-->
    
    <property name="bin-flash" location="${bin}/flash"/>
    <property name="lib-flash" location="${bin-flash}/lib/alphaSynth"/>
	<property name="haxe-flash-swf" location="${lib-flash}/alphaSynthFlashOnly.swf"/>
	<property name="haxe-flash-api" location="${lib-flash}/alphaSynthFlashOnly.js"/>
	<property name="haxe-flashjsworker-swf" location="${lib-flash}/alphaSynthJsWorker.swf"/>
	<property name="haxe-flashjsworker-js" location="${lib-flash}/alphaSynthJsWorker.js"/>
	<property name="haxe-flashjsworker-api" location="${lib-flash}/alphaSynthJsWorkerApi.js"/>
    
	<!-- Haxe Builds -->
    <target name="all" depends="flashOnly,flashJsWorker">
        
    </target>
    
	<target name="flashOnly">
		<delete file="${haxe-flash-swf}" />
		<delete file="${haxe-flash-js}" />
        <exec executable="haxe" failonerror="true">
            <arg value="-cp" />
            <arg value="${src}"/>
            
            <arg value="-main" />
            <arg value="as.AlphaSynthFlash" />
            
            <arg value="-swf" />
            <arg value="${haxe-flash-swf}" />
            
            <arg value="-lib" />
            <arg value="format" />
            
            <arg value="-lib" />
            <arg value="mconsole" />
            
            <arg value="-swf-version" />
            <arg value="11.4" />
        </exec>
        <exec executable="haxe" failonerror="true">
            <arg value="-cp" />
            <arg value="${src}"/>
            
            <arg value="-main" />
            <arg value="as.AlphaSynthFlashApi" />
            
            <arg value="-js" />
            <arg value="${haxe-flash-api}" />
        </exec>
	</target>	
	<target name="flashJsWorker">
		<delete file="${haxe-flashjsworker-swf}" />
		<delete file="${haxe-flashjsworker-js}" />
		<delete file="${haxe-flashjsworker-api}" />
        <exec executable="haxe" failonerror="true">
            <arg value="-cp" />
            <arg value="${src}"/>
            
            <arg value="-main" />
            <arg value="as.AlphaSynthFlashPlayer" />
            
            <arg value="-swf" />
            <arg value="${haxe-flashjsworker-swf}" />
            
            <arg value="-lib" />
            <arg value="format" />
            
            <arg value="-lib" />
            <arg value="mconsole" />
            
            <arg value="-swf-version" />
            <arg value="11.4" />
        </exec>
        <exec executable="haxe" failonerror="true">
            <arg value="-cp" />
            <arg value="${src}"/>
            
            <arg value="-main" />
            <arg value="as.AlphaSynthJsWorker" />
            
            <arg value="-lib" />
            <arg value="mconsole" />

            <arg value="-D" />
            <arg value="samsung" />

            <arg value="-js" />
            <arg value="${haxe-flashjsworker-js}" />
        </exec>
        <exec executable="haxe" failonerror="true">
            <arg value="-cp" />
            <arg value="${src}"/>
            
            <arg value="-main" />
            <arg value="as.AlphaSynthFlashPlayerApi" />
            
            <arg value="-js" />
            <arg value="${haxe-flashjsworker-api}" />
        </exec>
	</target>	
	
    <property name="bin-cs" location="${bin}/cs"/>
    <property name="haxe-cs" location="${bin-cs}/AlphaSynth.Core"/> 
    
	<!-- Haxe Builds -->
	<target name="cs">
		<mkdir dir="${bin-cs}" />
		<delete dir="${haxe-cs}/src" />
        <exec executable="haxe" failonerror="true">
            <arg value="-cp" />
            <arg value="${src}"/>
            
            <arg value="-D" />
            <arg value="real-position" />
            
            <arg value="-D" />
            <arg value="no-compilation" />
            
            <arg value="-D" />
            <arg value="no-root" />
            
            <arg value="-main" />
            <arg value="as.AlphaSynthCs" />
            
            <arg value="-cs" />
            <arg value="${haxe-cs}" />
        </exec>
	</target>	

</project>
